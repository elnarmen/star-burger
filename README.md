# Сайт доставки еды Star Burger
Это сайт сети ресторанов Star Burger. Здесь можно заказать превосходные бургеры с доставкой на дом.

Ознакомиться с сайтом можете здесь [elnar.tech](elnar.tech)

![скриншот сайта](https://dvmn.org/filer/canonical/1594651635/686/)

Сеть Star Burger объединяет несколько ресторанов, действующих под единой франшизой. У всех ресторанов одинаковое меню и одинаковые цены. Просто выберите блюдо из меню на сайте и укажите место доставки. Мы сами найдём ближайший к вам ресторан, всё приготовим и привезём.
На сайте есть три независимых интерфейса. Первый — это публичная часть, где можно выбрать блюда из меню, и быстро оформить заказ без регистрации и SMS.
Второй интерфейс предназначен для менеджера. Здесь происходит обработка заказов. Менеджер видит поступившие новые заказы и первым делом созванивается с клиентом, чтобы подтвердить заказ. После оператор выбирает ближайший ресторан и передаёт туда заказ на исполнение. Там всё приготовят и сами доставят еду клиенту.
Третий интерфейс — это админка. Преимущественно им пользуются программисты при разработке сайта. Также сюда заходит менеджер, чтобы обновить меню ресторанов Star Burger.
## dev-версия
#### Установка и настройка
Скачайте код:
```sh
git clone https://github.com/devmanorg/star-burger.git
```
Установите Docker и Docker-compose. [Ссылка на инструкцию.](https://www.howtogeek.com/devops/how-to-install-docker-and-docker-compose-on-linux/)

Создайте файл .env рядом с файлом manage.py в папке star-burger со следующими настройками:

* `YANDEX_API_KEY=<API ключ от яндекс гео-кодера>`. Получив его в [кабинете разработчика](https://developer.tech.yandex.ru/services/);
* `SECRET_KEY=<Секретный ключ проекта>`. Он отвечает за шифрование на сайте. Например, им зашифрованы все пароли на вашем сайте;
* `DEBUG=True`;
* `DB_URL=url базы данных`;<br>
С подробной инструкцией по установке базы данных можете ознакомиться на [сайте](https://www.digitalocean.com/community/tutorials/how-to-use-postgresql-with-your-django-application-on-ubuntu-14-04). <br>
После установки сформируйте url адрес вашей базы данных по шаблону:
```
postgres://<user>:<password>@localhost/<database_name>
```

#### Переменные окружения для отслеживания ошибок сайта (не обязательно) <br>
Для получения ROLLBAR_TOKEN нужно зарегистрироваться на [сайте](https://rollbar.com) и выбрать framework Django.
* `ROLLBAR_TOKEN=<ваш секретный ключ rollbar>`
* `ROLLBAR_ENV=<переменная, в которой хранится название окружения>`. По умолчанию установлен режим разработки `development`.
* `ROLLBAR_ENV=<ваше название окружения>`

  
#### Запуск

Запустите <b>docker-compose</b>:
```
docker-compose -f docker-compose.dev.yml up
```

Дождитесь окончания установки и запустите миграции:
```
docker-compose -f docker-compose.dev.yml exec web python star-burger/manage.py migrate
```

Сайт будет доступен по адресу [http://127.0.0.1:8000/](http://127.0.0.1:8000/). 

## prod-версия

Создайте файл `.env` в каталоге `star-burger` со следующими настройками:
- `SECRET_KEY` — секретный ключ проекта. Он отвечает за шифрование на сайте. Например, им зашифрованы все пароли на вашем сайте.
- `ALLOWED_HOSTS` — [см. документацию Django](https://docs.djangoproject.com/en/3.1/ref/settings/#allowed-hosts)
- `YANDEX_GEOCODER_API_KEY` — [Получите в кабинете разработчика](https://developer.tech.yandex.ru/services/)
- `ROLLBAR_TOKEN` — ваш секретный ключ rollbar (необязательная переменная)
- `ROLLBAR_ENV` — необязательная переменная, в которой хранится название окружения. По умолчанию установлен режим разработки `development`.
- `POSTGRES_DB` — название вашей базы данных
- `POSTGRES_USER` — имя пользователя базы данных
- `POSTGRES_PASSWORD` — пароль базы данных
- `DB_URL` — url адрес базы данных в PostgreSQL
Cформируйте url адрес вашей базы данных по шаблону:
```
postgres://имя пользователя базы данных:пароль базы данных@db/название базы данных
```

Запустите скрипт:
```
bash deploy.sh
```

